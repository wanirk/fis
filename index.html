<title>fis</title>
<body id="body">

<video controls  id="v" ></video>


<div id="p">

<input id="input" style="color:ffffff;background-color:000000"></input>
<button id="btn">Поиск</button>
</br>
</div>

</body>

<script src="https://cdn.jsdelivr.net/npm/hls.js"></script>
<script>
var video;
var vsrcs;
var titles;
var ready=false
var f;
vsrc=[]
btn=[]	
br=[]
href=[]	
p=document.getElementById("p")
p.style.marginLeft=v.width
input=document.getElementById("input")
input.style.backgroundColor="fffffff"
input.style.Color="000000"



body=document.getElementById("body");
body.bgColor="202020"
hls=new Hls();
vsrc=[]
title=[]
div=[]
seasons=1
found=document.getElementById("btn");
found.onclick=function(){
	f=input.value.toLowerCase()
	console.log(video.split(f).length)
	if(ready){
		if(video.split(f).length>1 && video.split(f).length<50){
			for(let q=0;q<btn.length;q++){
				btn[q].remove()
				br[q].remove()
			}
			for(let q=0;q<video.split(f).length-1;q++){
				href[q]=video.split(f)[q].split("\n")[video.split(f)[q].split("\n").length-1].split(":")[0];
				btn[q]=document.createElement("button")
				btn[q].style.color="ffffff"
				btn[q].style.backgroundColor="000000"
				br[q]=document.createElement("br")
				btn[q].textContent=href[q]+video.split(href[q])[1].split("\n")[0]
				btn[q].onclick=function(){
					vsrcs1=vsrcs.split(href[q]+":")[1].split("\n")[0]
					titles1=titles.split(href[q]+":")[1].split("\n")[0]
					console.log(vsrcs1)
					console.log(titles1)
					title=titles1.split(",")
					vsrc=vsrcs1.split(",")
					setsrc(vsrc[0])
					for(let i=0;i<video.split(f).length-1;i++){
						btn[i].remove();
					}
					table=document.createElement("table")
					body.appendChild(table)
					for(null;titles1.split(seasons+" сезон").length>1;seasons++){
						div[seasons]=document.createElement("div")
						div[seasons].style.width=200
						if(screen.width>screen.height){
							table.appendChild(div[seasons]);
							table.appendChild(document.createElement("th"))
						}else{
							body.appendChild(div[seasons])
						}
					}
					seasons=seasons
					for(let i=0;i<vsrc.length;i++){
						btn[i]=document.createElement("button")
						btn[i].style.color="ffffff"
						btn[i].style.backgroundColor="000000"
						br[i]=document.createElement("br")
						btn[i].textContent=title[i]
						btn[i].onclick=function(){
							setsrc(vsrc[i])
						}
						
						for(i1=1;i1<seasons;i1++){
							if(title[i].split(i1+" сезон").length>1){
								div[i1].appendChild(btn[i])
							}
						}
					}
				}
				p.appendChild(btn[q])
				p.appendChild(br[q])
			}
			
		}
		
	}else{
		p.value+="К сожалению файлы, необходимые для поиска ещё не загружены. Подождите какое-то время и попробуйте снова"
	}
}



par=location.href.split("?")[1];
if(par){
	setsrc(par);
}

var video=null
xhr=new XMLHttpRequest();
xhr.open("GET","https://raw.githubusercontent.com/wanirk/fis/main/video.txt")
xhr.onload=function(){
	video=xhr.response.toLowerCase();
	xhr.open("GET","https://raw.githubusercontent.com/wanirk/fis/main/vsrc.txt")
	xhr.onload=function(){
		vsrcs=xhr.response;
		xhr.open("GET","https://raw.githubusercontent.com/wanirk/fis/main/title.txt")
		xhr.onload=function(){
			titles=xhr.response.toLowerCase();
			ready=true
		}
		xhr.send()
	}
	xhr.send()
}
xhr.send();


function setsrc(url){
	v=document.getElementById("v");
	hls.loadSource("https://"+url+"/master.m3u8");
	hls.attachMedia(v);

}




</script>